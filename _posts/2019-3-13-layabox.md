---
layout:     post
title:      "Layabox小游戏实践小结"
subtitle:   ""
author:     "csy"
header-img: "img/home-bg2.jpg"
header-mask:  0.5
catalog: true
tags:
    - 前端
    - js
    - ts
    - layabox
---

## 前言

随着微信小游戏的大热，我们组的运营也坐不住了，开始。从18年9月份的时候开始接触Layabox游戏引擎，当时看了一篇文章对比了各大游戏引擎，作者安利Layabox，说是目前全球性能最高的HTML5引擎之一。

当时layabox官方已经发布了LayaAir1.0，但是想起大学课上用Dreamwearver的体验 :sweat:。感觉这种IDE拖控件生成代码的方式，过程比较无聊还耗时，而且生成的代码也比较冗余。考虑到第一个小游戏《玩个锤子》需求算比较简单，不需要用到物理引擎，入门开发尽量轻量级，省去学习IDE的时间成本，所以没有用官方的IDE，用TypeScript + layabox入门。

第二个小游戏《旋转吧胖胖》，需要用到物理引擎，而且之前尝试了TypeScript + layabox，要写很多的代码，比较辛苦，代码的可读性比较差。所以这个开发这个游戏，打算玩一玩LayaAir1.0。 嗯，真香。:neutral_face:

### 实现的游戏

![ts+layabox](/img/layabox/playHammer.png) ![js+layabox](/img/layabox/climb.png)

### 自适应全屏
设计稿是750 * 1334，为了自适应移动端各种尺寸的分辨率，我的实现是：

```js
GameConfig.width = 750;
GameConfig.height = 1334;
GameConfig.scaleMode ="fixedwidth"; //场景适配模式
GameConfig.screenMode = "none"; //场景横竖屏
GameConfig.alignV = "middle"; //垂直对齐模式
GameConfig.alignH = "center"; //水平对齐模式
```
编辑模式Scene场景宽高设置750*1334方便开发，代码模式```this.height = Laya.stage.height```设置Scene高度为stage舞台高度。

首页底部的内容用bottom定位，其余部分用y定位。高瘦屏和矮肥屏的效果图如下。
![ts+layabox](/img/layabox/toothJumpS.png) ![js+layabox](/img/layabox/toothJumpL.png)

### 常用的全局参数配置

- Laya.URL.basePath 通过basePath属性可以设置网络基础路径。如果不设置，默认为当前网页的路径。最终地址将被格式化为basePath+相对URL地址，适用于静态资源替换cdn地址。
在入口文件Main.js里的构造器配置，当时遇到一个坑，```Laya.URL.basePath='url'```一定要写在初始化```Laya.init(GameConfig.width, GameConfig.height, Laya["WebGL"]);```之后，否则不生效。

### 物理世界

Physics.I.worldRoot=场景
